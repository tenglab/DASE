row.names = FALSE,quote = FALSE)
write.table(se_profile_out$se_category,file = "demo_out/se_category.txt",sep='\t',
row.names = FALSE,quote = FALSE)
write.table(se_profile_out$se_category_sensitive,file = "demo_out/se_category_sensitive.txt",sep='\t',
row.names = FALSE,quote = FALSE)
write.table(se_profile_out$se_fit,file = "demo_out/enhancer_sp_fit.txt",sep='\t',
row.names = FALSE,quote = FALSE)
write.table(se_profile_out$se_deseq_out,file = "demo_out/enhancer_deseq_out.txt",sep='\t',
row.names = FALSE,quote = FALSE)
write.table(se_profile_out$se_seg,file = "demo_out/se_segment.txt",sep='\t',
row.names = FALSE,quote = FALSE)
write.table(se_profile_out$cutoff,file = "output_new/cutoff.txt",sep='\t',
row.names = FALSE,quote = FALSE)
pdf(file = "demo_out/boxplot.pdf")
se_profile_out$boxplot
dev.off()
pdf(file = "demo_out/permutation.pdf")
se_profile_out$density_plot
dev.off()
pdf("demo_out/MAplot.pdf")
plotMA(se_profile_out$lfc_shrink)
dev.off()
pattern_list <- se_profile_out$pattern_list
for (i in c(1:length(pattern_list))) {
# create out plot name
cat_dir <- se_profile_out$se_category$category[which(se_profile_out$se_category$se_merge_name==
pattern_list[[i]]$labels$title)]
pdf_name <- paste(gsub(" pattern", "",pattern_list[[i]]$labels$title),".pdf",sep="")
pdf_full_path <- paste0("demo_out/patterns/",cat_dir,"/",pdf_name)
# save to pdf
pdf(file = pdf_full_path,width = 8, height = 4)
print(pattern_list[[i]])
dev.off()
}
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
library(DASE)
?SEfilter
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
test_1<- SEfilter(se_in=se_region)
?knitr
?opts_chunk
# step_1: filter
step_1_out <- SEfilter(SE_region,bl_file = blacklist_df,has_bl_file = T)
# step_1: filter
step_1_out <- SEfilter(SE_region,bl_file = blacklist_df)
se_meta <- step_1_out$se_merged_meta
# step_1: filter
step_1_out <- SEfilter(se_region,bl_file = blacklist_df)
se_meta <- step_1_out$se_merged_meta
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
# step_1: filter
step_1_out <- SEfilter(se_region,bl_file = blacklist_df)
se_meta <- step_1_out$se_merged_meta
# step_2 enhancer foldchange
step_2_out <- enhancerFoldchange_bam(e_df = enhancer_region,
se_df = step_1_out$se_merged_meta,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam)
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out
se_profile_out$se_deseq_out
se_profile_out$se_fit
se_profile_out$pattern_list[[1]]
length(se_profile_out$pattern_list)
names(se_profile_out)
remove.packages("DASE")
devtools::install_github("https://github.com/tenglab/DASE.git")
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
library(DASE)
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
test_1<- SEfilter(se_in=se_region)
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
devtools:document()
devtools::document()
remove.packages("DASE")
devtools::install_github("https://github.com/tenglab/DASE.git")
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
library(DASE)
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
test_1<- SEfilter(se_in=se_region)
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
names(se_profile_out)
se_profile_out$pattern_list[[2]]
se_profile_out$pattern_list[[3]]
se_profile_out$pattern_list[[4]]
se_profile_out$pattern_list[[5]]
se_profile_out$pattern_list[[6]]
se_profile_out$pattern_list[[10]]
se_profile_out$se_category[which(se_profile_out$se_category$se_merge_name=="chr21_34863697_34890719"),]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,permut_type = 'stringent',
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$density_plot
se_profile_out_2$density_plot
devtools::document()
remove.packages("DASE")
devtools::install_github("https://github.com/tenglab/DASE.git")
se_in
se_region
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
layout(matrix(1:2,1,2))
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_2 <- DASE(se_in = SE_region,e_in = enhancer_region,
bl_file = blacklist_df, permut = F,
s1_pair = F, s2_pair = F,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
bl_file = blacklist_df, permut = F,
s1_pair = F, s2_pair = F,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
layout(matrix(1:2,1,2))
se_profile_out$boxplot
se_profile_out_2$boxplot
matrix(1:2,1,2)
devtools::document()
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
bl_file = blacklist_df, permut = F,
s1_pair = F, s2_pair = F,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
devtools::document()
devtools::document()
devtools::build_vignettes()
browseVignettes("DASE")
browseVignettes("DASE")
vignette("DASE")
browseVignettes("DASE")
install.packages('tinytex')
install.packages("tinytex")
tinytex::install_tinytex()
?featurecount
?featureCount
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
devtools::build_vignettes()
library(DASE)
?featurecounts
?featurecount
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/K562_MCF7_new/")
library(tidyr)
library(plyr)
library(dplyr)
library(tibble)
library(ggplot2)
library(scales)
library(data.table)
library(GenomicRanges)
library(DESeq2)
library(Rsubread)
library(apeglm)
library(splines)
?smooth.spline
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
library(DASE)
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
library(DASE)
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
data_type = "bw",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$pattern_list
se_profile_out$pattern_list[[1]]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$pattern_list[[1]]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$pattern_list[[2]]
se_profile_out_2$pattern_list[[2]]
se_profile_out_3$pattern_list[[2]]
se_profile_out_3$pattern_list[[3]]
se_profile_out_2$pattern_list[[3]]
se_profile_out_1$pattern_list[[3]]
se_profile_out$pattern_list[[3]]
se_profile_out$pattern_list[[4]]
se_profile_out_2$pattern_list[[4]]
se_profile_out$pattern_list[[4]]
se_profile_out_2$pattern_list[[4]]
se_profile_out_3$pattern_list[[4]]
se_profile_out_3$pattern_list[[5]]
se_profile_out_3$pattern_list[[6]]
se_profile_out_3$pattern_list[[7]]
se_profile_out_3$pattern_list[[8]]
se_profile_out_3$pattern_list[[7]]
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out_3$pattern_list[[7]]
se_profile_out_3$pattern_list[[6]]
se_profile_out_3$pattern_list[[5]]
se_profile_out_3$pattern_list[[4]]
se_profile_out_3$pattern_list[[3]]
se_profile_out_3$pattern_list[[2]]
se_profile_out_3$pattern_list[[1]]
se_profile_out_1$pattern_list[[1]]
se_profile_out_2$pattern_list[[1]]
se_profile_out_3$pattern_list[[1]]
se_profile_out$pattern_list[[1]]
se_profile_out_3$pattern_list[[1]]
se_profile_out_2$pattern_list[[1]]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
s1_r1_bw
s1_r1_bam = s1_r1_bw
s1_r1_bam
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw)
s1_out <- SEfilter(se_in,bl_file=bl_file,custom_range=custom_range)
s1_out <- SEfilter(se_region)
step_2_out <- enhancerFoldchange_bw(e_df=enhancer_region,se_df=s1_out$se_merged_meta,
s1_r1_bam=s1_r1_bam,s1_r2_bam=s1_r2_bam,
s2_r1_bam=s2_r1_bam ,s2_r2_bam=s2_r2_bam)
e_df=enhancer_region
se_df=s1_out$se_merged_meta
step_2_out <- enhancerFoldchange_bw(e_df=enhancer_region,se_df=s1_out$se_merged_meta,
s1_r1_bam=s1_r1_bw,s1_r2_bam=s1_r2_bw,
s2_r1_bam=s2_r1_bw ,s2_r2_bam=s2_r2_bw)
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
s1_out <- SEfilter(se_region)
step_2_out <- enhancerFoldchange_bw(e_df=enhancer_region,se_df=s1_out$se_merged_meta,
s1_r1_bam=s1_r1_bw,s1_r2_bam=s1_r2_bw,
s2_r1_bam=s2_r1_bw ,s2_r2_bam=s2_r2_bw)
step_3_out <- SEfitspline_smooth(step_2_out$enhancer_deseq_result)
step_3_out <- SEfitspline_bs(step_2_out$enhancer_deseq_result)
step_3_out <- SEfitspline_ns(step_2_out$enhancer_deseq_result)
step_3_out
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
library(DASE)
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
detach(DASE)
detach("DASE")
?DASE
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
