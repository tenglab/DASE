devtools::document()
devtools::document()
setwd("~/Projects/super_enhancer/se_diff_paper/PEL_GSE136090/")
# rose SE output table
main_sample_1_r1 <- read.table("input/BC1_1_peaks_Gateway_SuperEnhancers.bed",sep='\t', header =F)
main_sample_1_r2 <- read.table("input/BC1_2_peaks_Gateway_SuperEnhancers.bed",sep='\t', header =F)
main_sample_2_r1 <- read.table("input/BC3_1_peaks_Gateway_SuperEnhancers.bed",sep='\t', header =F)
main_sample_2_r2 <- read.table("input/BC3_2_peaks_Gateway_SuperEnhancers.bed",sep='\t', header =F)
se_rose_df <- rbind(main_sample_1_r1,main_sample_2_r1,main_sample_1_r2,main_sample_2_r2)
colnames(se_rose_df) <- c("CHROM","START","STOP","REGION_ID","Signal","STRAND")
blacklist_df <- read.table("../../ENCFF356LFX_blacklist.bed",sep = '\t')
enhancer_s1_r1 <- read.table("input/BC1_1_peaks.narrowPeak",sep='\t')
enhancer_s1_r2 <- read.table("input/BC1_2_peaks.narrowPeak",sep='\t')
enhancer_s2_r1 <- read.table("input/BC3_1_peaks.narrowPeak",sep='\t')
enhancer_s2_r2 <- read.table("input/BC3_2_peaks.narrowPeak",sep='\t')
pool_enhancer_df <- rbind(enhancer_s1_r1,enhancer_s1_r2,enhancer_s2_r1,enhancer_s2_r2)
colnames(pool_enhancer_df) <- c("chr", "start","end","name","score","strand",
"signalValue","pValue","qValue","peak")
setwd("~/Projects/super_enhancer/se_diff_paper/SEprofiler/")
devtools::load_all()
test_1_out <- SEfilter(se_rose_df,blacklist_df,has_bl_file=TRUE)
devtools::document()
test_1_out <- SEfilter(se_rose_df,blacklist_df,has_bl_file=TRUE)
devtools::document()
devtools::load_all()
devtools::document()
devtools::load_all()
devtools::document()
devtools::load_all()
devtools::document()
test_1_out <- SEfilter(se_rose_df,blacklist_df,has_bl_file=TRUE)
library(GenomicRanges)
test_1_out <- SEfilter(se_rose_df,blacklist_df,has_bl_file=TRUE)
test_1_out$se_merged_meta
s1_r1_bam <- "~/Projects/super_enhancer/se_diff_paper/PEL_GSE136090/input/BC1_1_rmdup_sort.bam"
s1_r2_bam <- "~/Projects/super_enhancer/se_diff_paper/PEL_GSE136090/input/BC1_2_rmdup_sort.bam"
s2_r1_bam <- "~/Projects/super_enhancer/se_diff_paper/PEL_GSE136090/input/BC3_1_rmdup_sort.bam"
s2_r2_bam <- "~/Projects/super_enhancer/se_diff_paper/PEL_GSE136090/input/BC3_2_rmdup_sort.bam"
se_meta <- test_1_out$se_merged_meta
test_1_out$se_filtered_no_bl
test_1_out$se_filtered_in_bl
nrow(test_1_out$se_filtered_no_bl)
nrow(se_merged_meta)
se_meta <- test_1_out$se_merged_meta
nrow(se_meta)
test_2_out <- enhancerFoldchange(pool_enhancer_df,se_meta,s1_r1_bam,s1_r2_bam,s2_r1_bam,s2_r2_bam)
test_2_out$size_factor
test_2_out$enhancer_deseq_result
devtools::load_all()
test_3_out <- SEfitspline(test_2_out$enhancer_deseq_result,se_meta)
devtools::document()
test_3_out <- SEfitspline(test_2_out$enhancer_deseq_result,se_meta)
library(splines)
test_3_out <- SEfitspline(test_2_out$enhancer_deseq_result,se_meta)
test_3_out <- SEfitspline(test_2_out$enhancer_deseq_result,se_meta)
test_3_out <- SEfitspline(test_2_out$enhancer_deseq_result,se_meta,times=1)
library(ggplot2)
test_3_out <- SEfitspline(test_2_out$enhancer_deseq_result,se_meta,times=1)
test_3_out$density_plot
test_3_out$cutoff
devtools::document()
devtools::load_all()
devtools::document()
test_4_out <- SEpattern(test_3_out$se_fit_df,test_3_out$cutoff)
test_4_out$se_segment_percent
devtools::document()
devtools::load_all()
main_out <- SEmain(se_in = se_rose_df,e_df = pool_enhancer_df,bl_file = blacklist_df,
has_bl_file = T,s1_r1_bam,s1_r2_bam,s2_r1_bam,s2_r2_bam)
detach
detach("data.table")
detach(data.table)
library(GenomicRanges)
main_out <- SEmain(se_in = se_rose_df,e_df = pool_enhancer_df,bl_file = blacklist_df,
has_bl_file = T,s1_r1_bam,s1_r2_bam,s2_r1_bam,s2_r2_bam)
devtools::document()
devtools::load_all()
main_out <- SEmain(se_in = se_rose_df,e_df = pool_enhancer_df,bl_file = blacklist_df,
has_bl_file = T,s1_r1_bam,s1_r2_bam,s2_r1_bam,s2_r2_bam)
main_out <- SEmain(se_in = se_rose_df,e_df = pool_enhancer_df,bl_file = blacklist_df,
has_bl_file = T,s1_r1_bam=s1_r1_bam,s1_r2_bam=s1_r2_bam,s2_r1_bam=s2_r1_bam,s2_r2_bam=s2_r2_bam)
devtools::uses_testthat()
devtools::uses_testthat()
devtools::uses_testthat()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
remove.packages("SEprofiler")
devtools::document()
devtools::document()
devtools::document()
devtools::load_all()
devtools::document()
remove.packages("SEprofiler")
remove.packages("SEprofiler")
devtools::document()
devtools::document()
