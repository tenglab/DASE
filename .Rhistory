s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$pattern_list
se_profile_out$pattern_list[[1]]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$pattern_list[[1]]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out$pattern_list[[2]]
se_profile_out_2$pattern_list[[2]]
se_profile_out_3$pattern_list[[2]]
se_profile_out_3$pattern_list[[3]]
se_profile_out_2$pattern_list[[3]]
se_profile_out_1$pattern_list[[3]]
se_profile_out$pattern_list[[3]]
se_profile_out$pattern_list[[4]]
se_profile_out_2$pattern_list[[4]]
se_profile_out$pattern_list[[4]]
se_profile_out_2$pattern_list[[4]]
se_profile_out_3$pattern_list[[4]]
se_profile_out_3$pattern_list[[5]]
se_profile_out_3$pattern_list[[6]]
se_profile_out_3$pattern_list[[7]]
se_profile_out_3$pattern_list[[8]]
se_profile_out_3$pattern_list[[7]]
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bam,s1_r2_bam = s1_r2_bam,
s2_r1_bam = s2_r1_bam,s2_r2_bam = s2_r2_bam))
se_profile_out_3$pattern_list[[7]]
se_profile_out_3$pattern_list[[6]]
se_profile_out_3$pattern_list[[5]]
se_profile_out_3$pattern_list[[4]]
se_profile_out_3$pattern_list[[3]]
se_profile_out_3$pattern_list[[2]]
se_profile_out_3$pattern_list[[1]]
se_profile_out_1$pattern_list[[1]]
se_profile_out_2$pattern_list[[1]]
se_profile_out_3$pattern_list[[1]]
se_profile_out$pattern_list[[1]]
se_profile_out_3$pattern_list[[1]]
se_profile_out_2$pattern_list[[1]]
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
s1_r1_bw
s1_r1_bam = s1_r1_bw
s1_r1_bam
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw)
s1_out <- SEfilter(se_in,bl_file=bl_file,custom_range=custom_range)
s1_out <- SEfilter(se_region)
step_2_out <- enhancerFoldchange_bw(e_df=enhancer_region,se_df=s1_out$se_merged_meta,
s1_r1_bam=s1_r1_bam,s1_r2_bam=s1_r2_bam,
s2_r1_bam=s2_r1_bam ,s2_r2_bam=s2_r2_bam)
e_df=enhancer_region
se_df=s1_out$se_merged_meta
step_2_out <- enhancerFoldchange_bw(e_df=enhancer_region,se_df=s1_out$se_merged_meta,
s1_r1_bam=s1_r1_bw,s1_r2_bam=s1_r2_bw,
s2_r1_bam=s2_r1_bw ,s2_r2_bam=s2_r2_bw)
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
s1_out <- SEfilter(se_region)
step_2_out <- enhancerFoldchange_bw(e_df=enhancer_region,se_df=s1_out$se_merged_meta,
s1_r1_bam=s1_r1_bw,s1_r2_bam=s1_r2_bw,
s2_r1_bam=s2_r1_bw ,s2_r2_bam=s2_r2_bw)
step_3_out <- SEfitspline_smooth(step_2_out$enhancer_deseq_result)
step_3_out <- SEfitspline_bs(step_2_out$enhancer_deseq_result)
step_3_out <- SEfitspline_ns(step_2_out$enhancer_deseq_result)
step_3_out
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
library(DASE)
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
detach(DASE)
detach("DASE")
?DASE
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw)
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bam = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bam = s2_r2_bw))
se_profile_out$pattern_list[[1]]
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bw = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bw = s2_r2_bw))
system.time(se_profile_out <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="ns",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bam = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bam = s2_r2_bw))
system.time(se_profile_out_2 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="bs",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bam = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bam = s2_r2_bw))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
custom_range = c("chr21:14735763-29634779","chr21:33539902-43710703"),
permut=F,
spline_fun="smooth",
data_type = "bw",
s1_r1_bam = s1_r1_bw,s1_r2_bam = s1_r2_bw,
s2_r1_bam = s2_r1_bw,s2_r2_bam = s2_r2_bw))
se_profile_out$density_plot
se_profile_out$pattern_list[[1]]
se_profile_out_2$pattern_list[[1]]
se_profile_out_3$pattern_list[[1]]
se_profile_out_3$pattern_list[[2]]
se_profile_out_2$pattern_list[[2]]
se_profile_out$pattern_list[[2]]
se_profile_out$pattern_list[[7]]
se_profile_out_2$pattern_list[[7]]
se_profile_out_3$pattern_list[[7]]
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
devtools::build_vignettes()
library(DASE)
# rose SE output_new table
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
blacklist_path <- system.file("extdata","region_blacklist.bed",package="DASE")
blacklist_df <- read.table(blacklist_path,sep="\t",header=F)
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
# BAM files
s1_r1_bam <- system.file("extdata","K562_1_chr21.bam",package="DASE")
s1_r2_bam <- system.file("extdata","K562_2_chr21.bam",package="DASE")
s2_r1_bam <- system.file("extdata","MCF7_1_chr21.bam",package="DASE")
s2_r2_bam <- system.file("extdata","MCF7_2_chr21.bam",package="DASE")
s1_r1_bam
# BigWig files
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
s1_r1_bw
system.time(se_profile_out_3 <- DASE(se_in = SE_region,e_in = enhancer_region,
enhancer_count_table = enhancer_count))
system.time(se_profile_out_3 <- DASE(se_in = se_region,e_in = enhancer_region,
enhancer_count_table = enhancer_count))
# path of BigWig file for each condition
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
# running DASE with BigWig files
DASE_out <- DASE(se_in=se_region,e_in=enhancer_region,data_type = "bw",
s1_r1_bam=s1_r1_bw,s1_r2_bam=s1_r2_bw,
s2_r1_bam=s2_r1_bw,s2_r2_bam=s2_r2_bw)
# run DASE with b spline function
DASE_out_ns <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,
spline_fun = "ns")
# run DASE with smooth spline function
DASE_out_smooth <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,
spline_fun = "smooth")
# run DASE with b spline function
DASE_out_ns <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,
spline_fun = "ns")
DASE_out_ns$pattern_list[[7]]
DASE_out_ns$pattern_list[[7]]
DASE_out_smooth$pattern_list[[7]]
DASE_out_ns$pattern_list[[6]]
DASE_out_smooth$pattern_list[[6]]
DASE_out_ns$pattern_list[[8]]
DASE_out_smooth$pattern_list[[8]]
DASE_out_smooth$pattern_list[[9]]
DASE_out_smooth$pattern_list[[10]]
# rund DASE with b-spline function (default)
DASE_out_bs <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F)
# run DASE with natural spline function
DASE_out_ns <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F,
spline_fun = "ns")
# run DASE with smooth spline function
DASE_out_smooth <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F,
spline_fun = "smooth")
# spline fitted plots of different spline functions
DASE_out_bs$pattern_list[[7]]
DASE_out_ns$pattern_list[[7]]
DASE_out_smooth$pattern_list[[7]]
DASE_out_ns <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F,
spline_fun = "ns")
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
devtools::build_vignettes()
.Last.error.trace
devtools::install_github("https://github.com/tenglab/DASE.git")
```{r, figures-side, fig.show="hold", out.width="50%"}
# run DASE with permutation 3 times
DASE_out <- DASE(se_in=se_region,e_in=enhancer_region,times=3,
cutoff_v = c(-2,2),enhancer_count_table=enhancer_count)
# run DASE with no permutation and customized threshold
DASE_out_p <- DASE(se_in=se_region,e_in=enhancer_region,permut = F,
cutoff_v = c(-3,3),enhancer_count_table=enhancer_count)
# boxplots of different threshold
par(mar = c(4, 4, .1, .1))
DASE_out_count$boxplot
DASE_out_count$boxplot
# rund DASE with b-spline function (default)
DASE_out_bs <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F)
# run DASE with natural spline function
DASE_out_ns <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F,
spline_fun = "ns")
# run DASE with smooth spline function
DASE_out_smooth <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count,permut=F,
spline_fun = "smooth")
# spline fitted plots of different spline functions
par(mfrow = c(1, 3))
DASE_out_bs$pattern_list[[7]]
DASE_out_ns$pattern_list[[7]]
?par()
DASE_out_bs$pattern_list[[7]]
par(mfrow = c(1, 3))
DASE_out_bs$pattern_list[[7]]
DASE_out_ns$pattern_list[[7]]
DASE_out_smooth$pattern_list[[7]]
par(mfrow = c(1, 3))
print(DASE_out_bs$pattern_list[[7]])
print(DASE_out_bs$pattern_list[[7]])
print(DASE_out_bs$pattern_list[[7]])
DASE_out_bs$pattern_list[[7]]
grid.arrange(DASE_out_bs$pattern_list[[7]],
DASE_out_ns$pattern_list[[7]],
DASE_out_smooth$pattern_list[[7]])
library(gridExtra)
grid.arrange(DASE_out_bs$pattern_list[[7]],
DASE_out_ns$pattern_list[[7]],
DASE_out_smooth$pattern_list[[7]])
?grid.arrange()
grid.arrange(DASE_out_bs$pattern_list[[7]],
DASE_out_ns$pattern_list[[7]],
DASE_out_smooth$pattern_list[[7]],nrow=1)
grid.arrange(DASE_out_bs$pattern_list[[7]],
DASE_out_ns$pattern_list[[7]],
DASE_out_smooth$pattern_list[[7]],nrow=1)
# boxplots of different threshold
library(gridExtra)
grid.arrange(DASE_out_count$boxplot,
DASE_out_p$boxplot,nrow=1)
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
devtools::load_all()
# load enhancer BED file
enhancer_path <- system.file("extdata","enhancer.bed",package="DASE")
enhancer_region <- read.table(enhancer_path,sep="\t",header=F)
head(enhancer_region)
# load SE BED file
se_path <- system.file("extdata","SE.bed",package="DASE")
se_region <- read.table(se_path,sep="\t",header=F)
head(se_region)
# path of BigWig file for each condition
s1_r1_bw <- system.file("extdata","K562_1_chr21.bw",package="DASE")
s1_r2_bw <- system.file("extdata","K562_2_chr21.bw",package="DASE")
s2_r1_bw <- system.file("extdata","MCF7_1_chr21.bw",package="DASE")
s2_r2_bw <- system.file("extdata","MCF7_2_chr21.bw",package="DASE")
# running DASE with BigWig files
DASE_out <- DASE(se_in=se_region,e_in=enhancer_region,data_type = "bw",
s1_r1_bam=s1_r1_bw,s1_r2_bam=s1_r2_bw,
s2_r1_bam=s2_r1_bw,s2_r2_bam=s2_r2_bw)
# read enhancer count table
enhancer_count_path <- system.file("extdata","chr21_enhancer_count.txt",package="DASE")
enhancer_count <- read.table(enhancer_count_path,sep="\t",header=T)
head(enhancer_count)
# run DASE
DASE_out_count <- DASE(se_in=se_region,e_in=enhancer_region,
enhancer_count_table=enhancer_count)
# spline fitted plots of different spline functions
library(gridExtra)
grid.arrange(DASE_out_bs$pattern_list[[7]],
DASE_out_ns$pattern_list[[7]],
DASE_out_smooth$pattern_list[[7]],nrow=1)
# Significant threshold
DASE_out_count$cutoff
# Permutation density plot
DASE_out_count$density_plot
# se_categories
head(DASE_out_count$se_category)
# an example of one sample
DASE_out_count$pattern_list[[1]]
# example of ce_fit
head(DASE_out_count$ce_fit)
devtools::install_github("https://github.com/tenglab/DASE.git")
sessionInfo()
packageVersion("rtracklayer")
packageVersion("ggplot2")
packageVersion("splines")
packageVersion("devtools")
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
# set work directory
setwd("~/Projects/super_enhancer/se_diff_paper/DASE/")
devtools::document()
devtools::install_github("https://github.com/tenglab/DASE.git")
packageVersion("tidyr")
